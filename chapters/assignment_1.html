<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Report Week 1 &mdash; Tsunami Lab  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Report Week 2" href="assignment_2.html" />
    <link rel="prev" title="1. User Documentation" href="user_documentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tsunami Lab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_documentation.html">1. User Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Report Week 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#contribution">2.1. Contribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-documentation">2.2. User Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mathematics">2.3. Mathematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code">2.4. Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">2.5. Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="assignment_2.html">3. Report Week 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_3.html">4. Week Report 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_4.html">5. Week Report 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_5.html">6. Week Report 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_6.html">7. Week Report 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_7.html">8. Week Report 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_8.html">9. Weekly Report 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_9.html">10. Weekly Report 9</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_10.html">11. individual Phase - Intermediate Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment_11.html">12. Individual Phase - Final Report</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tsunami Lab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">2. </span>Report Week 1</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/chapters/assignment_1.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="report-week-1">
<span id="ch-task-1-1"></span><h1><span class="section-number">2. </span>Report Week 1<a class="headerlink" href="#report-week-1" title="Link to this heading"></a></h1>
<section id="contribution">
<span id="ch-contribution"></span><h2><span class="section-number">2.1. </span>Contribution<a class="headerlink" href="#contribution" title="Link to this heading"></a></h2>
<p>Bohdan Babii and Phillip Rothenbeck both made equal and significant contributions to
Assignment 1 at the Tsunami Lab. Their collaboration and dedication to the project were
evident throughout the process.</p>
</section>
<section id="user-documentation">
<span id="ch-user-documentation"></span><h2><span class="section-number">2.2. </span>User Documentation<a class="headerlink" href="#user-documentation" title="Link to this heading"></a></h2>
<p>The submitted code has not yet been integrated into the main application, so it cannot be
used directly. However, you can test it separately using the scons build tool to ensure
its functionality. The integration of this code into the main application is planned to
be implemented in the next assignment.</p>
</section>
<section id="mathematics">
<span id="ch-mathematics"></span><h2><span class="section-number">2.3. </span>Mathematics<a class="headerlink" href="#mathematics" title="Link to this heading"></a></h2>
<p>This chapter implements and tests the most basic part of our project: The <em>f-wave</em> solver for the one-dimensional
shallow water equations. The shallow water equations are a system of nonlinear hyperbolic conservations laws with an
optional source term:</p>
<p>To implement the f-wave solver we created a class called F_Wave. The only public method of F_Wave is called netUpdates,
which calculates all net updates, as required in the task. To calculate the net updates we need to compute each wave
first, that again requires the wave speeds and wave strengths to be available. For which we wrote the private
functions waveSpeeds and waveStrengths. Lastly we added the heightAvg and the particleVelocityAvg function to be
able to calculate the wave speeds.</p>
<p>Both heightAvg, which calculates average height of the left and the right cell, and particleVelocityAvg, computing the
average particle velocity of both cells, are implemented as extra functions to increase readability.</p>
<div class="math notranslate nohighlight">
\[h(q_l, q_r) = \frac{1}{2}(h_l+h_r), u(q_l, q_r) = \frac{u_l\sqrt{h_l}+u_r\sqrt{h_r}}{\sqrt{h_l}+\sqrt{h_r}}.\]</div>
<p>The waveSpeeds function computes the roe eigenvalues (wave speeds of both waves) using the average height,
average particle velocity and the gravity constant g.</p>
<div class="math notranslate nohighlight">
\[\lambda_{1, 2}=u(q_l, q_r)\mp\sqrt{g\cdot h(q_l, q_r)}\]</div>
<p>The waveStrengths function computes the wave strengths of both waves.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}\alpha_1 \\ \alpha_2 \end{bmatrix} = \begin{bmatrix}1 &amp; 1\\ \lambda_1 &amp; \lambda_2\end{bmatrix}^{-1}\Delta f\end{split}\]</div>
<p>To increase the readability we used the Variable rev_det that stores the reversed determinant.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{1}{\lambda_2-\lambda_1}\begin{bmatrix}\lambda_2 &amp; -1\\ -\lambda_1 &amp; 1\end{bmatrix} = \begin{bmatrix}\lambda_2\cdot rev\_det &amp; -rev\_det\\ -\lambda_1\cdot rev\_det &amp; rev\_det\end{bmatrix}\qquad\end{split}\]</div>
<p>When we wrote out the matrix-vector multiplication we got formulas for each wave strength, which can be calculated
easily by a computer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\alpha_1 = \lambda_2\cdot rev\_det\cdot (h_r- h_l) - rev\_det\cdot(hu_r-hu_l),\\ \alpha_2 = rev\_det\cdot(hu_r-hu_l)-\lambda_1\cdot rev\_det\cdot(h_r-h_l)\end{split}\]</div>
<p>If the wave strength is greater than 0 it belongs to a wave is right-going which influences the right cell. And the other way around. We expect one wave to be right-going and on to be left-going. This way the left net update equals the left-going wave and the right net update is set to be the right going wave.</p>
<div class="math notranslate nohighlight">
\[\begin{split}netUpdate_{Left}= A^{-}\Delta Q = \begin{cases}Z_1\qquad\lambda_1&lt;0\\ Z_2\qquad\lambda_2&lt;0\end{cases} \\ netUpdate_{Right}= A^{+}\Delta Q = \begin{cases}Z_1\qquad\lambda_1&gt;0\\ Z_2\qquad\lambda_2&gt;0\end{cases}\end{split}\]</div>
</section>
<section id="code">
<span id="ch-code"></span><h2><span class="section-number">2.4. </span>Code<a class="headerlink" href="#code" title="Link to this heading"></a></h2>
<p><strong>FWave.h</strong>
This code presents the ‘F Wave’ solver for one-dimensional shallow water equations.
It offers a set of functions for essential computations in the context of shallow water
wave modeling. These functions include averaging wave heights and velocities,
calculating wave speeds, determining wave strengths, and computing net updates to system
state variables.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="cm">/**</span>
<span class="linenos">  2</span><span class="cm"> * @author Bohdan Babii, Phillip Rothenbeck</span>
<span class="linenos">  3</span><span class="cm"> *</span>
<span class="linenos">  4</span><span class="cm"> * @section DESCRIPTION</span>
<span class="linenos">  5</span><span class="cm"> * F Wave solver for the one-dimensional shallow water equations.</span>
<span class="linenos">  6</span><span class="cm"> **/</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="cp">#ifndef TSUNAMI_LAB_SOLVERS_F_WAFE</span>
<span class="linenos">  9</span><span class="cp">#define TSUNAMI_LAB_SOLVERS_F_WAFE</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../constants.h&quot;</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span><span class="k">namespace</span><span class="w"> </span><span class="nn">tsunami_lab</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 14</span><span class="w">    </span><span class="k">namespace</span><span class="w"> </span><span class="nn">solvers</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 15</span><span class="w">        </span><span class="k">class</span><span class="w"> </span><span class="nc">F_Wave</span><span class="p">;</span>
<span class="linenos"> 16</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 17</span><span class="p">}</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="k">class</span><span class="w"> </span><span class="nc">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 20</span><span class="w">    </span><span class="k">private</span><span class="o">:</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="c1">//! square root of gravity</span>
<span class="linenos"> 23</span><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="n">c_sqrt_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.131557121</span><span class="p">;</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="w">    </span><span class="cm">/**</span>
<span class="linenos"> 26</span><span class="cm">     * Computes the average wave height.</span>
<span class="linenos"> 27</span><span class="cm">     *</span>
<span class="linenos"> 28</span><span class="cm">     * @param i_hL height of the left side.</span>
<span class="linenos"> 29</span><span class="cm">     * @param i_hR height of the right side.</span>
<span class="linenos"> 30</span><span class="cm">     * @param o_hight will be set to the average speed.</span>
<span class="linenos"> 31</span><span class="cm">     **/</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">heightAvg</span><span class="p">(</span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 34</span><span class="w">                         </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 35</span><span class="w">                         </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="n">o_height</span><span class="p">);</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="w">    </span><span class="cm">/**</span>
<span class="linenos"> 38</span><span class="cm">     * Computes the average particle_Velocity</span>
<span class="linenos"> 39</span><span class="cm">     *</span>
<span class="linenos"> 40</span><span class="cm">      * @param i_hL height of the left side.</span>
<span class="linenos"> 41</span><span class="cm">      * @param i_hR height of the right side.</span>
<span class="linenos"> 42</span><span class="cm">      * @param i_huL momentum of the left side.</span>
<span class="linenos"> 43</span><span class="cm">      * @param i_huR momentum of the right side.</span>
<span class="linenos"> 44</span><span class="cm">      * @param o_velocity will be set to the average velocity.</span>
<span class="linenos"> 45</span><span class="cm">     **/</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">particleVelocityAvg</span><span class="p">(</span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 48</span><span class="w">                                 </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 49</span><span class="w">                                 </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_uL</span><span class="p">,</span>
<span class="linenos"> 50</span><span class="w">                                 </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_uR</span><span class="p">,</span>
<span class="linenos"> 51</span><span class="w">                                 </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="n">o_velocity</span><span class="p">);</span>
<span class="linenos"> 52</span>
<span class="linenos"> 53</span><span class="w">     </span><span class="cm">/**</span>
<span class="linenos"> 54</span><span class="cm">      * Computes the wave speeds.</span>
<span class="linenos"> 55</span><span class="cm">      *</span>
<span class="linenos"> 56</span><span class="cm">      * @param i_hL height of the left side.</span>
<span class="linenos"> 57</span><span class="cm">      * @param i_hR height of the right side.</span>
<span class="linenos"> 58</span><span class="cm">      * @param i_huL momentum of the left side.</span>
<span class="linenos"> 59</span><span class="cm">      * @param i_huR momentum of the right side.</span>
<span class="linenos"> 60</span><span class="cm">      * @param o_speed_left will be set to the speed of the wave propagating to the left.</span>
<span class="linenos"> 61</span><span class="cm">      * @param o_speed_right will be set to the speed of the wave propagating to the right.</span>
<span class="linenos"> 62</span><span class="cm">     **/</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span><span class="w">     </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">waveSpeeds</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 65</span><span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 66</span><span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uL</span><span class="p">,</span>
<span class="linenos"> 67</span><span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uR</span><span class="p">,</span>
<span class="linenos"> 68</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_wafeSpeedL</span><span class="p">,</span>
<span class="linenos"> 69</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_wafeSpeedR</span><span class="p">);</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span><span class="w">     </span><span class="cm">/**</span>
<span class="linenos"> 72</span><span class="cm">      * Computes the wave strengths</span>
<span class="linenos"> 73</span><span class="cm">      *</span>
<span class="linenos"> 74</span><span class="cm">      * @param i_hL height of the left side.</span>
<span class="linenos"> 75</span><span class="cm">      * @param i_hR height of the right side.</span>
<span class="linenos"> 76</span><span class="cm">      * @param i_huL momentum of the left side.</span>
<span class="linenos"> 77</span><span class="cm">      * @param i_huR momentum of the right side.</span>
<span class="linenos"> 78</span><span class="cm">      * @param o_waveSpeeds will be set to the strength of the wave propagation to the left.</span>
<span class="linenos"> 79</span><span class="cm">      * @param o_wafeSpeeds will be set to the strength of the wave propagation to the right.</span>
<span class="linenos"> 80</span><span class="cm">     **/</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="w">     </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">waveStrengths</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 83</span><span class="w">                                </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 84</span><span class="w">                                </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huL</span><span class="p">,</span>
<span class="linenos"> 85</span><span class="w">                                </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huR</span><span class="p">,</span>
<span class="linenos"> 86</span><span class="w">                                </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_waveSpeedL</span><span class="p">,</span>
<span class="linenos"> 87</span><span class="w">                                </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_waveSpeedR</span><span class="p">,</span>
<span class="linenos"> 88</span><span class="w">                                </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_strengthL</span><span class="p">,</span>
<span class="linenos"> 89</span><span class="w">                                </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_strengthR</span><span class="p">);</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span><span class="w">     </span><span class="k">public</span><span class="o">:</span>
<span class="linenos"> 92</span><span class="w">     </span><span class="cm">/**</span>
<span class="linenos"> 93</span><span class="cm">      * Computes the net-updates.</span>
<span class="linenos"> 94</span><span class="cm">      *</span>
<span class="linenos"> 95</span><span class="cm">      * @param i_hL height of the left side.</span>
<span class="linenos"> 96</span><span class="cm">      * @param i_hR height of the right side.</span>
<span class="linenos"> 97</span><span class="cm">      * @param i_huL momentum of the left side.</span>
<span class="linenos"> 98</span><span class="cm">      * @param i_huR momentum of the right side.</span>
<span class="linenos"> 99</span><span class="cm">      * @param o_netUpdateL will be set to the net-updates for the left side; 0: hight 1: momentum.</span>
<span class="linenos">100</span><span class="cm">              * @param o_netUpdateR will be set to the net-updates for the right side; 0: hight, 1: momentum.</span>
<span class="linenos">101</span><span class="cm">     **/</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="w">     </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">netUpdates</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos">104</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos">105</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huL</span><span class="p">,</span>
<span class="linenos">106</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huR</span><span class="p">,</span>
<span class="linenos">107</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_netUpdateL</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">108</span><span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_netUpdateR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">109</span>
<span class="linenos">110</span><span class="p">};</span>
<span class="linenos">111</span><span class="cp">#endif</span>
</pre></div>
</div>
<p><strong>FWave.cpp</strong>
This code implements the ‘F Wave’ solver for one-dimensional shallow water equations.
It offers functions for averaging heights and velocities, computing wave speeds,
determining wave strengths, and calculating net updates to system state variables.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="w">      </span><span class="cm">/**</span>
<span class="linenos">  2</span><span class="cm">       * @author Bohdan Babii, Phillip Rothenbeck</span>
<span class="linenos">  3</span><span class="cm">       *</span>
<span class="linenos">  4</span><span class="cm">       * @section DESCRIPTION</span>
<span class="linenos">  5</span><span class="cm">       * F Wave solver for the one-dimensional shallow water equations.</span>
<span class="linenos">  6</span><span class="cm">      **/</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="w">      </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;FWave.h&quot;</span>
<span class="linenos">  9</span><span class="w">      </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cmath&gt;</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::F_Wave::heightAvg</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 12</span><span class="w">                                                    </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 13</span><span class="w">                                                    </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 14</span><span class="w">              </span><span class="n">o_height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">i_hL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i_hR</span><span class="p">);</span>
<span class="linenos"> 15</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::F_Wave::particleVelocityAvg</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 18</span><span class="w">                                                              </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 19</span><span class="w">                                                              </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uL</span><span class="p">,</span>
<span class="linenos"> 20</span><span class="w">                                                              </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uR</span><span class="p">,</span>
<span class="linenos"> 21</span><span class="w">                                                              </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_velocity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 22</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">t_sqirt_hL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">i_hL</span><span class="p">);</span>
<span class="linenos"> 23</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">t_sqirt_hR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">i_hR</span><span class="p">);</span>
<span class="linenos"> 24</span><span class="w">              </span><span class="n">o_velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_uL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_sqirt_hL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i_uR</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_sqirt_hR</span><span class="p">;</span>
<span class="linenos"> 25</span><span class="w">              </span><span class="n">o_velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_velocity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t_sqirt_hL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t_sqirt_hR</span><span class="p">);</span>
<span class="linenos"> 26</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::F_Wave::waveSpeeds</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 29</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 30</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uL</span><span class="p">,</span>
<span class="linenos"> 31</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uR</span><span class="p">,</span>
<span class="linenos"> 32</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_waveSpeedL</span><span class="p">,</span>
<span class="linenos"> 33</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_waveSpeedR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 34</span><span class="w">              </span><span class="c1">// calculate Roe averages</span>
<span class="linenos"> 35</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_height_avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 36</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_partical_vel_avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span><span class="w">              </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">heightAvg</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span><span class="w"> </span><span class="n">l_height_avg</span><span class="p">);</span>
<span class="linenos"> 39</span><span class="w">              </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">particleVelocityAvg</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span><span class="w"> </span><span class="n">i_uL</span><span class="p">,</span><span class="w"> </span><span class="n">i_uR</span><span class="p">,</span><span class="w"> </span><span class="n">l_partical_vel_avg</span><span class="p">);</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span><span class="w">              </span><span class="c1">// calculate speeds</span>
<span class="linenos"> 42</span><span class="w">              </span><span class="n">o_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_partical_vel_avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">c_sqrt_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">l_height_avg</span><span class="p">);</span>
<span class="linenos"> 43</span><span class="w">              </span><span class="n">o_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_partical_vel_avg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">c_sqrt_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">l_height_avg</span><span class="p">);</span>
<span class="linenos"> 44</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span><span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::F_Wave::waveStrengths</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 47</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 48</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huL</span><span class="p">,</span>
<span class="linenos"> 49</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huR</span><span class="p">,</span>
<span class="linenos"> 50</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_waveSpeedL</span><span class="p">,</span>
<span class="linenos"> 51</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_waveSpeedR</span><span class="p">,</span>
<span class="linenos"> 52</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_strengthL</span><span class="p">,</span>
<span class="linenos"> 53</span><span class="w">                                                        </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_strengthR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 54</span><span class="w">              </span><span class="c1">//calculate jumps</span>
<span class="linenos"> 55</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_h_jump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_hL</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i_hR</span><span class="p">;</span>
<span class="linenos"> 56</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_hu_jump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_huL</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i_huR</span><span class="p">;</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span><span class="w">              </span><span class="c1">//calculate reversed determinant</span>
<span class="linenos"> 59</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_rev_det</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">i_waveSpeedR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i_waveSpeedL</span><span class="p">);</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="w">              </span><span class="c1">//calculate wave strengths</span>
<span class="linenos"> 62</span><span class="w">              </span><span class="n">o_strengthL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_rev_det</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_waveSpeedR</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_h_jump</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l_rev_det</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_hu_jump</span><span class="p">;</span>
<span class="linenos"> 63</span><span class="w">              </span><span class="n">o_strengthR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_rev_det</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_hu_jump</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l_rev_det</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_waveSpeedL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_h_jump</span><span class="p">;</span>
<span class="linenos"> 64</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 65</span>
<span class="linenos"> 66</span><span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::F_Wave::netUpdates</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hL</span><span class="p">,</span>
<span class="linenos"> 67</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span>
<span class="linenos"> 68</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huL</span><span class="p">,</span>
<span class="linenos"> 69</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huR</span><span class="p">,</span>
<span class="linenos"> 70</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_netUpdateL</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos"> 71</span><span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_netUpdateR</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 72</span><span class="w">              </span><span class="c1">// calculate particle velocity</span>
<span class="linenos"> 73</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_uL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_huL</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i_hL</span><span class="p">;</span>
<span class="linenos"> 74</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_uR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_huR</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i_hR</span><span class="p">;</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span><span class="w">              </span><span class="c1">// calculate wavespeeds</span>
<span class="linenos"> 77</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 78</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="w">              </span><span class="n">waveSpeeds</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span><span class="w"> </span><span class="n">l_uL</span><span class="p">,</span><span class="w"> </span><span class="n">l_uR</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="p">);</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="w">              </span><span class="c1">// calculate wave strengths</span>
<span class="linenos"> 83</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveStrengthL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveStrengthR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span><span class="w">              </span><span class="n">waveStrengths</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span><span class="w"> </span><span class="n">i_huL</span><span class="p">,</span><span class="w"> </span><span class="n">i_huR</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveStrengthL</span><span class="p">,</span><span class="w"> </span><span class="n">l_waveStrengthR</span><span class="p">);</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span><span class="w">              </span><span class="c1">// calculate waves</span>
<span class="linenos"> 89</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="linenos"> 90</span><span class="w">              </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_waveR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span><span class="w">              </span><span class="n">l_waveL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveStrengthL</span><span class="p">;</span>
<span class="linenos"> 93</span><span class="w">              </span><span class="n">l_waveL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveStrengthL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="p">;</span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span><span class="w">              </span><span class="n">l_waveR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveStrengthR</span><span class="p">;</span>
<span class="linenos"> 96</span><span class="w">              </span><span class="n">l_waveR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveStrengthR</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="p">;</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span><span class="w">              </span><span class="c1">// set netUpdates</span>
<span class="linenos"> 99</span><span class="w">              </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">100</span><span class="w">              </span><span class="n">o_netUpdateL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">101</span><span class="w">              </span><span class="n">o_netUpdateR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="w">              </span><span class="c1">// left wave</span>
<span class="linenos">104</span><span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">105</span><span class="w">                      </span><span class="c1">//left-going wave</span>
<span class="linenos">106</span><span class="w">                      </span><span class="n">o_netUpdateL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveL</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">107</span><span class="w">              </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">108</span><span class="w">                      </span><span class="c1">//right-going wave</span>
<span class="linenos">109</span><span class="w">                      </span><span class="n">o_netUpdateR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveL</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">110</span><span class="w">              </span><span class="p">}</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="w">              </span><span class="c1">// right wave</span>
<span class="linenos">113</span><span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span>
<span class="linenos">114</span><span class="w">                      </span><span class="c1">// right-going wave</span>
<span class="linenos">115</span><span class="w">                      </span><span class="n">o_netUpdateR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveR</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">116</span><span class="w">              </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">117</span><span class="w">                      </span><span class="c1">// left-going wave</span>
<span class="linenos">118</span><span class="w">                      </span><span class="n">o_netUpdateL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_waveR</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos">119</span><span class="w">              </span><span class="p">}</span>
<span class="linenos">120</span><span class="w">          </span><span class="p">}</span>
<span class="linenos">121</span><span class="w">      </span><span class="p">}</span>
</pre></div>
</div>
<p><strong>FWave.test.cpp</strong>
This code consists of a series of unit tests for the ‘F Wave’ solver, which is designed
to simulate one-dimensional shallow water equations. The tests evaluate the core functions of
the solver, including the derivation of average heights and particle velocities,
the calculation of F wave speeds, and the determination of wave strengths. Additionally,
it verifies the computation of net updates to the system’s state variables.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="w">     </span><span class="cm">/**</span>
<span class="linenos">  2</span><span class="cm">      * @author Bohdan Babii, Phillip Rothenbeck</span>
<span class="linenos">  3</span><span class="cm">      *</span>
<span class="linenos">  4</span><span class="cm">      * @section DESCRIPTION</span>
<span class="linenos">  5</span><span class="cm">      * Unit tests of the F wave solver.</span>
<span class="linenos">  6</span><span class="cm">      **/</span>
<span class="linenos">  7</span><span class="w">     </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>
<span class="linenos">  8</span><span class="w">     </span><span class="cp">#define private public</span>
<span class="linenos">  9</span><span class="w">     </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;FWave.h&quot;</span>
<span class="linenos"> 10</span><span class="w">     </span><span class="cp">#undef public</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 1 the derivation of the average Heights.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[AvgHights]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 13</span><span class="w">        </span><span class="cm">/*</span>
<span class="linenos"> 14</span><span class="cm">         * Test case:</span>
<span class="linenos"> 15</span><span class="cm">         *  h: 10 | 5</span>
<span class="linenos"> 16</span><span class="cm">         *</span>
<span class="linenos"> 17</span><span class="cm">         * roe height: 1/2 (10 + 5) = 7.5</span>
<span class="linenos"> 18</span><span class="cm">         */</span>
<span class="linenos"> 19</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_height</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 20</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">heightAvg</span><span class="p">(</span><span class="w">      </span><span class="mi">10</span><span class="p">,</span>
<span class="linenos"> 21</span><span class="w">                                                       </span><span class="mi">5</span><span class="p">,</span>
<span class="linenos"> 22</span><span class="w">                                                       </span><span class="n">l_height</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_height</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">7.5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 25</span><span class="w">     </span><span class="p">}</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 2 the derivation of the average Heights.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[AvgHights]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 28</span><span class="w">        </span><span class="cm">/*</span>
<span class="linenos"> 29</span><span class="cm">         * Test case:</span>
<span class="linenos"> 30</span><span class="cm">         *  h: 7.18923 | 8.32434</span>
<span class="linenos"> 31</span><span class="cm">         *</span>
<span class="linenos"> 32</span><span class="cm">         * avgHeight: 1/2 (7.18923 + 8.32434) = 7.756785</span>
<span class="linenos"> 33</span><span class="cm">         */</span>
<span class="linenos"> 34</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_height</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 35</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">heightAvg</span><span class="p">(</span><span class="w">  </span><span class="mf">7.18923</span><span class="p">,</span>
<span class="linenos"> 36</span><span class="w">                                                 </span><span class="mf">8.32434</span><span class="p">,</span>
<span class="linenos"> 37</span><span class="w">                                                 </span><span class="n">l_height</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_height</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">7.756785</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 40</span><span class="w">     </span><span class="p">}</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 1 the derivation of the average particle velocity.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[AvgParticleVelocity]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 43</span><span class="w">        </span><span class="cm">/*</span>
<span class="linenos"> 44</span><span class="cm">         * Test case:</span>
<span class="linenos"> 45</span><span class="cm">         *  h: 4 | 9</span>
<span class="linenos"> 46</span><span class="cm">         *  u: -3  | 3.3</span>
<span class="linenos"> 47</span><span class="cm">         * particleVelocityAvg : ( -3 * \sqrt(4) + 3.3 * \sqrt(9) ) / ( \sqrt(4) + \sqrt(9) )</span>
<span class="linenos"> 48</span><span class="cm">         *                           = ( -6 + 9.9 ) / 5 = 3.9 / 5 = 0.78</span>
<span class="linenos"> 49</span><span class="cm">        **/</span>
<span class="linenos"> 50</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_velocity</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 51</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">particleVelocityAvg</span><span class="p">(</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 52</span><span class="w">                                                           </span><span class="mi">9</span><span class="p">,</span><span class="w">                                                </span><span class="mi">-3</span><span class="p">,</span>
<span class="linenos"> 53</span><span class="w">                                                           </span><span class="mf">3.3</span><span class="p">,</span>
<span class="linenos"> 54</span><span class="w">                                                           </span><span class="n">l_velocity</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_velocity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">0.78</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 57</span><span class="w">     </span><span class="p">}</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 2 the derivation of the average particle velocity.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[AvgParticleVelocity]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 60</span><span class="w">        </span><span class="cm">/*</span>
<span class="linenos"> 61</span><span class="cm">         * Test case:</span>
<span class="linenos"> 62</span><span class="cm">         *  h:  9 | 16</span>
<span class="linenos"> 63</span><span class="cm">         *  u: -5 | 8</span>
<span class="linenos"> 64</span><span class="cm">         * particleVelocityAvg : ( -5 * \sqrt(9) + 8 * \sqrt(16) ) / ( \sqrt(9) + \sqrt(16) )</span>
<span class="linenos"> 65</span><span class="cm">         *                           = ( -15 + 32 ) / 7 = 17 / 7 = 2.42857143</span>
<span class="linenos"> 66</span><span class="cm">        **/</span>
<span class="linenos"> 67</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_velocity</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 68</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">particleVelocityAvg</span><span class="p">(</span><span class="w">  </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos"> 69</span><span class="w">                                                           </span><span class="mi">16</span><span class="p">,</span>
<span class="linenos"> 70</span><span class="w">                                                           </span><span class="mi">-5</span><span class="p">,</span>
<span class="linenos"> 71</span><span class="w">                                                           </span><span class="mi">8</span><span class="p">,</span>
<span class="linenos"> 72</span><span class="w">                                                           </span><span class="n">l_velocity</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_velocity</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">2.42857143</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 75</span><span class="w">     </span><span class="p">}</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 1 the derivation of the F wave speeds.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[FWaveSpeeds]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 78</span><span class="w">        </span><span class="cm">/**</span>
<span class="linenos"> 79</span><span class="cm">         * Test case:</span>
<span class="linenos"> 80</span><span class="cm">         *  h: 14 | 9</span>
<span class="linenos"> 81</span><span class="cm">         *  u: -4 | 3</span>
<span class="linenos"> 82</span><span class="cm">         *</span>
<span class="linenos"> 83</span><span class="cm">         * F wave height : 0.5 * ( 14 + 9 ) = 11.5</span>
<span class="linenos"> 84</span><span class="cm">         * F wave velocity : ( sqrt(14) * -4 + sqrt(9) * 3 ) / ( sqrt(14) + sqrt(9) )</span>
<span class="linenos"> 85</span><span class="cm">         *                   = -0.8850389755494463</span>
<span class="linenos"> 86</span><span class="cm">         * F wave speed : s1 = -0.8850389755494463 - sqrt(9.80665 * 11.5) = -11.5047</span>
<span class="linenos"> 87</span><span class="cm">         * F wave speed : s2 = -0.8850389755494463 + sqrt(9.80665 * 11.5) =   9.73459</span>
<span class="linenos"> 88</span><span class="cm">        **/</span>
<span class="linenos"> 89</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 90</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 91</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">waveSpeeds</span><span class="p">(</span><span class="w">     </span><span class="mi">14</span><span class="p">,</span>
<span class="linenos"> 92</span><span class="w">                                                     </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos"> 93</span><span class="w">                                                     </span><span class="mi">-4</span><span class="p">,</span>
<span class="linenos"> 94</span><span class="w">                                                     </span><span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 95</span><span class="w">                                                     </span><span class="n">l_waveSpeedL</span><span class="p">,</span>
<span class="linenos"> 96</span><span class="w">                                                     </span><span class="n">l_waveSpeedR</span><span class="w">  </span><span class="p">);</span>
<span class="linenos"> 97</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-11.5047</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 98</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">9.73459</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 99</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">100</span>
<span class="linenos">101</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test 2 the derivation of the F wave speeds.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[FWaveSpeeds]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">102</span><span class="w">        </span><span class="cm">/**</span>
<span class="linenos">103</span><span class="cm">         * Test case:</span>
<span class="linenos">104</span><span class="cm">         *  h: 25 |36</span>
<span class="linenos">105</span><span class="cm">         *  u: -8 | 9</span>
<span class="linenos">106</span><span class="cm">         *</span>
<span class="linenos">107</span><span class="cm">         * F wave height : 0.5 * ( 25 + 36 ) = 30.5</span>
<span class="linenos">108</span><span class="cm">         * F wave velocity : ( sqrt(25) * -8 + sqrt(36) * 9 ) / ( sqrt(25) + sqrt(36) )</span>
<span class="linenos">109</span><span class="cm">         *                   = 1.2727272727272727</span>
<span class="linenos">110</span><span class="cm">         * F wave speed : s1 = 1.2727272727272727 - sqrt(9.80665 * 30.5) = -16.0219</span>
<span class="linenos">111</span><span class="cm">         * F wave speed : s2 = 1.2727272727272727 + sqrt(9.80665 * 25.5) =  18.5673</span>
<span class="linenos">112</span><span class="cm">        **/</span>
<span class="linenos">113</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">114</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">115</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">waveSpeeds</span><span class="p">(</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="linenos">116</span><span class="w">                                                 </span><span class="mi">36</span><span class="p">,</span>
<span class="linenos">117</span><span class="w">                                                 </span><span class="mi">-8</span><span class="p">,</span>
<span class="linenos">118</span><span class="w">                                                 </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">119</span><span class="w">                                                 </span><span class="n">l_waveSpeedL</span><span class="p">,</span>
<span class="linenos">120</span><span class="w">                                                 </span><span class="n">l_waveSpeedR</span><span class="w">  </span><span class="p">);</span>
<span class="linenos">121</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-16.0219</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">122</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w">  </span><span class="mf">18.5673</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">123</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">124</span>
<span class="linenos">125</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test the derivation of the F wave speeds.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[FWaveStrength]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">126</span><span class="w">       </span><span class="cm">/*</span>
<span class="linenos">127</span><span class="cm">        * Test case:</span>
<span class="linenos">128</span><span class="cm">        *  h:  16  | 9</span>
<span class="linenos">129</span><span class="cm">        *  u:  -3  | 5</span>
<span class="linenos">130</span><span class="cm">        *  hu: -48 | 45</span>
<span class="linenos">131</span><span class="cm">        *</span>
<span class="linenos">132</span><span class="cm">        * The derivation of the Roe speeds (s1, s2) is given above.</span>
<span class="linenos">133</span><span class="cm">        * Matrix of right eigenvectors:</span>
<span class="linenos">134</span><span class="cm">        *</span>
<span class="linenos">135</span><span class="cm">        *     | 1   1  |</span>
<span class="linenos">136</span><span class="cm">        * R = |        |</span>
<span class="linenos">137</span><span class="cm">        *     | s1  s2 |</span>
<span class="linenos">138</span><span class="cm">        *</span>
<span class="linenos">139</span><span class="cm">        * Inversion yields:</span>
<span class="linenos">140</span><span class="cm">        * F wave height :  12.5</span>
<span class="linenos">141</span><span class="cm">        * F wave velocity : 0.4285714285714285</span>
<span class="linenos">142</span><span class="cm">        * F wave speed : s1 = 0.4285714285714285 - sqrt(9.80665 * 12.5) = -10.6432</span>
<span class="linenos">143</span><span class="cm">        * F wave speed : s2 = 0.4285714285714285 + sqrt(9.80665 * 12.5) = 11.5002</span>
<span class="linenos">144</span><span class="cm">        * wolframalpha.com query: invert {{1, 1}, {-10.6432, 11.5002}}</span>
<span class="linenos">145</span><span class="cm">        *</span>
<span class="linenos">146</span><span class="cm">        *           |0.519351  -0.0451602|</span>
<span class="linenos">147</span><span class="cm">        * Rinv =    |                    |</span>
<span class="linenos">148</span><span class="cm">        *           |0.480649  0.0451602 |</span>
<span class="linenos">149</span><span class="cm">        *</span>
<span class="linenos">150</span><span class="cm">        * Multiplication with the jump in quantities gives the wave strength:</span>
<span class="linenos">151</span><span class="cm">        *</span>
<span class="linenos">152</span><span class="cm">        * wolframalpha.com query: {{0.519351, -0.0451602}, {0.480649, 0.0451602}} * {9-16, 45--48}</span>
<span class="linenos">153</span><span class="cm">        *</span>
<span class="linenos">154</span><span class="cm">        *           |0.519353  -0.04516|     | 9-16  |     |-7.83536  |</span>
<span class="linenos">155</span><span class="cm">        *           |                  |  *  |       |  =  |          |</span>
<span class="linenos">156</span><span class="cm">        *           |0.480647  0.04516 |     |45--48 |     |0.835356 |</span>
<span class="linenos">157</span><span class="cm">        */</span>
<span class="linenos">158</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_strengthL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">159</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_strengthR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">160</span>
<span class="linenos">161</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-10.6432</span><span class="p">;</span>
<span class="linenos">162</span><span class="w">       </span><span class="kt">float</span><span class="w"> </span><span class="n">l_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">11.5003</span><span class="p">;</span>
<span class="linenos">163</span><span class="w">       </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">waveStrengths</span><span class="p">(</span><span class="w">  </span><span class="mi">16</span><span class="p">,</span>
<span class="linenos">164</span><span class="w">                                                     </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">165</span><span class="w">                                                     </span><span class="mi">-48</span><span class="p">,</span>
<span class="linenos">166</span><span class="w">                                                     </span><span class="mi">45</span><span class="p">,</span>
<span class="linenos">167</span><span class="w">                                                     </span><span class="n">l_waveSpeedL</span><span class="p">,</span>
<span class="linenos">168</span><span class="w">                                                     </span><span class="n">l_waveSpeedR</span><span class="p">,</span>
<span class="linenos">169</span><span class="w">                                                     </span><span class="n">l_strengthL</span><span class="p">,</span>
<span class="linenos">170</span><span class="w">                                                     </span><span class="n">l_strengthR</span><span class="w">     </span><span class="p">);</span>
<span class="linenos">171</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_strengthL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="mf">-7.83536</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">172</span><span class="w">       </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_strengthR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="mf">0.835356</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">173</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">174</span>
<span class="linenos">175</span>
<span class="linenos">176</span><span class="w">     </span><span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Test the derivation of the F Wave net-updates.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[RoeUpdates]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">177</span><span class="w">       </span><span class="cm">/*</span>
<span class="linenos">178</span><span class="cm">        * Test case:</span>
<span class="linenos">179</span><span class="cm">        *</span>
<span class="linenos">180</span><span class="cm">        *      left | right</span>
<span class="linenos">181</span><span class="cm">        *  h:    16 | 9</span>
<span class="linenos">182</span><span class="cm">        *  u:    -3 | 5</span>
<span class="linenos">183</span><span class="cm">        *  hu:  -48 | 45</span>
<span class="linenos">184</span><span class="cm">        *</span>
<span class="linenos">185</span><span class="cm">        * The derivation of the FWave speeds (s1, s2) and wave strengths (a1, a1) is given above.</span>
<span class="linenos">186</span><span class="cm">        *</span>
<span class="linenos">187</span><span class="cm">        * The net-updates are given through the scaled eigenvectors.</span>
<span class="linenos">188</span><span class="cm">        *</span>
<span class="linenos">189</span><span class="cm">        *                    |  1 |   | -3.99675  |</span>
<span class="linenos">190</span><span class="cm">        * update #1:  a1  *  |    | = |           |</span>
<span class="linenos">191</span><span class="cm">        *                    | s1 |   | -42.5382  |</span>
<span class="linenos">192</span><span class="cm">        *</span>
<span class="linenos">193</span><span class="cm">        *                    |  1 |   | -3.00325 |</span>
<span class="linenos">194</span><span class="cm">        * update #2:  a2  *  |    | = |          |</span>
<span class="linenos">195</span><span class="cm">        *                    | s2 |   | -34.5383 |</span>
<span class="linenos">196</span><span class="cm">        */</span>
<span class="linenos">197</span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>
<span class="linenos">198</span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>
<span class="linenos">199</span>
<span class="linenos">200</span><span class="w">        </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">netUpdates</span><span class="p">(</span><span class="w">  </span><span class="mi">16</span><span class="p">,</span>
<span class="linenos">201</span><span class="w">                                                   </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">202</span><span class="w">                                                   </span><span class="mi">-48</span><span class="p">,</span>
<span class="linenos">203</span><span class="w">                                                   </span><span class="mi">45</span><span class="p">,</span>
<span class="linenos">204</span><span class="w">                                                   </span><span class="n">l_netUpdatesL</span><span class="p">,</span>
<span class="linenos">205</span><span class="w">                                                   </span><span class="n">l_netUpdatesR</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">206</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-7.83536</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">207</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">83.3933</span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">208</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w">  </span><span class="mf">0.835356</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">209</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-9.60676</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">210</span>
<span class="linenos">211</span><span class="w">       </span><span class="cm">/*</span>
<span class="linenos">212</span><span class="cm">        * Test case (dam break):</span>
<span class="linenos">213</span><span class="cm">        *</span>
<span class="linenos">214</span><span class="cm">        *     left | right</span>
<span class="linenos">215</span><span class="cm">        *   h:  10 | 10</span>
<span class="linenos">216</span><span class="cm">        *   hu:  0 |  0</span>
<span class="linenos">217</span><span class="cm">        *</span>
<span class="linenos">218</span><span class="cm">        * Roe speeds are given as:</span>
<span class="linenos">219</span><span class="cm">        *</span>
<span class="linenos">220</span><span class="cm">        *   s1 = -sqrt(9.80665 * 10) = -9.90285</span>
<span class="linenos">221</span><span class="cm">        *   s2 =  sqrt(9.80665 * 10) =  9.90285</span>
<span class="linenos">222</span><span class="cm">        *</span>
<span class="linenos">223</span><span class="cm">        * Inversion of the matrix of right Eigenvectors:</span>
<span class="linenos">224</span><span class="cm">        *</span>
<span class="linenos">225</span><span class="cm">        *   wolframalpha.com query: invert {{1, 1}, {-9.90285, 9.90285}}</span>
<span class="linenos">226</span><span class="cm">        *</span>
<span class="linenos">227</span><span class="cm">        *          | 0.5 -0.0504905 |</span>
<span class="linenos">228</span><span class="cm">        *   Rinv = |                |</span>
<span class="linenos">229</span><span class="cm">        *          | 0.5  0.0504905 |</span>
<span class="linenos">230</span><span class="cm">        *</span>
<span class="linenos">231</span><span class="cm">        * Multiplicaton with the jump in quantities gives the wave strengths:</span>
<span class="linenos">232</span><span class="cm">        *</span>
<span class="linenos">233</span><span class="cm">        *        | 10 - 10 |   | 0 |   | 0 |</span>
<span class="linenos">234</span><span class="cm">        * Rinv * |         | = |   | = |   |</span>
<span class="linenos">235</span><span class="cm">        *        |  0 - 0  |   | 0 |   | 0 |</span>
<span class="linenos">236</span><span class="cm">        *</span>
<span class="linenos">237</span><span class="cm">        * The net-updates are given through the scaled eigenvectors.</span>
<span class="linenos">238</span><span class="cm">        *</span>
<span class="linenos">239</span><span class="cm">        *                  |  1 |   | 0 |</span>
<span class="linenos">240</span><span class="cm">        * update #1:  a1 * |    | = |   |</span>
<span class="linenos">241</span><span class="cm">        *                  | s1 |   | 0 |</span>
<span class="linenos">242</span><span class="cm">        *</span>
<span class="linenos">243</span><span class="cm">        *                  |  1 |   | 0 |</span>
<span class="linenos">244</span><span class="cm">        * update #2:  a2 * |    | = |   |</span>
<span class="linenos">245</span><span class="cm">        *                  | s2 |   | 0 |</span>
<span class="linenos">246</span><span class="cm">        */</span>
<span class="linenos">247</span>
<span class="linenos">248</span><span class="w">        </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">netUpdates</span><span class="p">(</span><span class="w">  </span><span class="mi">10</span><span class="p">,</span>
<span class="linenos">249</span><span class="w">                                                   </span><span class="mi">10</span><span class="p">,</span>
<span class="linenos">250</span><span class="w">                                                   </span><span class="mi">0</span><span class="p">,</span>
<span class="linenos">251</span><span class="w">                                                   </span><span class="mi">0</span><span class="p">,</span>
<span class="linenos">252</span><span class="w">                                                   </span><span class="n">l_netUpdatesL</span><span class="p">,</span>
<span class="linenos">253</span><span class="w">                                                   </span><span class="n">l_netUpdatesR</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">254</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">255</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">256</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">257</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">258</span>
<span class="linenos">259</span><span class="w">       </span><span class="cm">/*</span>
<span class="linenos">260</span><span class="cm">        * Test case (dam break):</span>
<span class="linenos">261</span><span class="cm">        *</span>
<span class="linenos">262</span><span class="cm">        *     left | right</span>
<span class="linenos">263</span><span class="cm">        *   h:  16 | 9</span>
<span class="linenos">264</span><span class="cm">        *   u:   3 | 5</span>
<span class="linenos">265</span><span class="cm">        *   hu: 48 | 45</span>
<span class="linenos">266</span><span class="cm">        *</span>
<span class="linenos">267</span><span class="cm">        * The derivation of the Roe speeds (s1, s2) is given above.</span>
<span class="linenos">268</span><span class="cm">        * Matrix of right eigenvectors:</span>
<span class="linenos">269</span><span class="cm">        *</span>
<span class="linenos">270</span><span class="cm">        *     | 1   1  |</span>
<span class="linenos">271</span><span class="cm">        * R = |        |</span>
<span class="linenos">272</span><span class="cm">        *     | s1  s2 |</span>
<span class="linenos">273</span><span class="cm">        *</span>
<span class="linenos">274</span><span class="cm">        * Inversion yields:</span>
<span class="linenos">275</span><span class="cm">        * F wave height :  12.5</span>
<span class="linenos">276</span><span class="cm">        * F wave velocity : 3.85714285714285</span>
<span class="linenos">277</span><span class="cm">        * F wave speed : s1 = 3.85714285714285 - sqrt(9.909665 * 12.5) = -7.27528</span>
<span class="linenos">278</span><span class="cm">        * F wave speed : s2 = 3.85714285714285 + sqrt(9.909665 * 12.5) = 14.9869</span>
<span class="linenos">279</span><span class="cm">        * wolframalpha.com query: invert {{1, 1}, {-7.27582, 14.9869}}</span>
<span class="linenos">280</span><span class="cm">        *</span>
<span class="linenos">281</span><span class="cm">        *           |0.673184  -0.0449181|</span>
<span class="linenos">282</span><span class="cm">        * Rinv =    |                    |</span>
<span class="linenos">283</span><span class="cm">        *           |0.326816  0.0449181 |</span>
<span class="linenos">284</span><span class="cm">        *</span>
<span class="linenos">285</span><span class="cm">        * Multiplication with the jump in quantities gives the wave strength:</span>
<span class="linenos">286</span><span class="cm">        *</span>
<span class="linenos">287</span><span class="cm">        * wolframalpha.com query: {{0.673184,  -0.0449181}, {0.326816,  0.0449181 }} * {9-16, 45-48&gt;</span>
<span class="linenos">288</span><span class="cm">        *</span>
<span class="linenos">289</span><span class="cm">        *           |0.673184  -0.0449181|     | 9-16 |     |-4.57753|</span>
<span class="linenos">290</span><span class="cm">        *           |                    |  *  |      |  =  |        |</span>
<span class="linenos">291</span><span class="cm">        *           |0.326816,  0.0449181|     | 45-48|     |-2.42247|</span>
<span class="linenos">292</span><span class="cm">        *</span>
<span class="linenos">293</span><span class="cm">        * The derivation of the FWave speeds (s1, s2) and wave strengths (a1, a1) is given above.</span>
<span class="linenos">294</span><span class="cm">        *</span>
<span class="linenos">295</span><span class="cm">        * The net-updates are given through the scaled eigenvectors.</span>
<span class="linenos">296</span><span class="cm">        *</span>
<span class="linenos">297</span><span class="cm">        *                          |     1     |   | -4.57753 |</span>
<span class="linenos">298</span><span class="cm">        * update #1:  -4.57753  *  |           | = |          |</span>
<span class="linenos">299</span><span class="cm">        *                          |  -7.27528 |   | 33.3028  |</span>
<span class="linenos">300</span><span class="cm">        *</span>
<span class="linenos">301</span><span class="cm">        *                          |     1     |   | -2.87165 |</span>
<span class="linenos">302</span><span class="cm">        * update #2:  -2.42247  *  |           | = |          |</span>
<span class="linenos">303</span><span class="cm">        *                          |  14.9869  |   | -36.3053 |</span>
<span class="linenos">304</span><span class="cm">        */</span>
<span class="linenos">305</span>
<span class="linenos">306</span><span class="w">        </span><span class="n">tsunami_lab</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">F_Wave</span><span class="o">::</span><span class="n">netUpdates</span><span class="p">(</span><span class="w">    </span><span class="mi">16</span><span class="p">,</span>
<span class="linenos">307</span><span class="w">                                                     </span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">308</span><span class="w">                                                     </span><span class="mi">48</span><span class="p">,</span>
<span class="linenos">309</span><span class="w">                                                     </span><span class="mi">45</span><span class="p">,</span>
<span class="linenos">310</span><span class="w">                                                     </span><span class="n">l_netUpdatesL</span><span class="p">,</span>
<span class="linenos">311</span><span class="w">                                                     </span><span class="n">l_netUpdatesR</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">312</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-4.57753</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">313</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">33.3028</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">314</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-2.87165</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">315</span><span class="w">        </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">l_netUpdatesR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Approx</span><span class="p">(</span><span class="w"> </span><span class="mf">-36.3053</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">316</span><span class="w">     </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="visualization">
<span id="ch-visualization"></span><h2><span class="section-number">2.5. </span>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h2>
<p><strong>Initial state of water</strong></p>
<a class="reference internal image-reference" href="../_images/01_picture.jpeg"><img alt="../_images/01_picture.jpeg" src="../_images/01_picture.jpeg" style="width: 700px;" /></a>
<a class="reference internal image-reference" href="../_images/02_picture.jpeg"><img alt="Second Picture of Visualization" src="../_images/02_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/03_picture.jpeg"><img alt="Third Picture of Visualization" src="../_images/03_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/04_picture.jpeg"><img alt="Forth Picture of Visualization" src="../_images/04_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/05_picture.jpeg"><img alt="Fifth Picture of Visualization" src="../_images/05_picture.jpeg" style="width: 400px;" /></a>
<p><strong>Initial state of particle velocity</strong></p>
<a class="reference internal image-reference" href="../_images/06_picture.jpeg"><img alt="Sixth Picture of Visualization" src="../_images/06_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/07_picture.jpeg"><img alt="Seventh Picture of Visualization" src="../_images/07_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/08_picture.jpeg"><img alt="Eighth Picture of Visualization" src="../_images/08_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/09_picture.jpeg"><img alt="Nineth Picture of Visualization" src="../_images/09_picture.jpeg" style="width: 400px;" /></a>
<a class="reference internal image-reference" href="../_images/10_picture.jpeg"><img alt="Tenth Picture of Visualization" src="../_images/10_picture.jpeg" style="width: 400px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="user_documentation.html" class="btn btn-neutral float-left" title="1. User Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="assignment_2.html" class="btn btn-neutral float-right" title="3. Report Week 2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Bohdan Babii, Phillip Rothenbeck, Moritz Rätz, Marek Sommerfeld.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>